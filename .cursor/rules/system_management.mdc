---
description: "System management practices for the Living Truth Engine, including environment setup, automation, and monitoring"
globs: ["**/*.sh", "**/*.py", "**/scripts/**/*", "**/.env*"]
alwaysApply: true
---

---
description: "System management practices for the Living Truth Engine, including environment setup, automation, and monitoring"
globs: ["**/*.sh", "**/*.py", "**/scripts/**/*", "**/.env*"]
alwaysApply: true
---

# System Management and Automation

## Description
This rule defines system management practices for the Living Truth Engine, including environment setup, automation, and monitoring.

## ğŸ–¥ï¸ **System Configuration Standards**

### **Environment Management**
```bash
# âœ… Good - Use virtual environment
source living_venv/bin/activate

# âœ… Good - Environment-driven configuration
export AGI_DASHBOARD_PORT=8050
export AGI_LOG_LEVEL=INFO
export AGI_ENVIRONMENT=development
```

### **Python Environment**
```bash
# âœ… Good - Canonical environment usage
# Always use living_venv for all operations
source living_venv/bin/activate

# âœ… Good - Environment validation
python -c "import sys; print('Environment:', sys.executable)"
```

### **System Updates**
```bash
# âœ… Good - Automated system updates
./scripts/setup/update_system.sh

# âœ… Good - Component-specific updates
# Docker: Latest Engine, Compose v2, BuildKit
# Node.js: Latest LTS version
# Python: Latest packages and dependencies
```

## ğŸ“‹ **System Management Checklist**

### **Environment Setup**
- [ ] **Activate virtual environment** before any Python operations
- [ ] **Use environment variables** for configuration
- [ ] **Validate environment** before operations
- [ ] **Check dependencies** are installed
- [ ] **Verify MCP server** is running

### **System Maintenance**
- [ ] **Update system components** regularly
- [ ] **Clean up unused resources** (Docker, logs, cache)
- [ ] **Monitor system resources** (CPU, memory, disk)
- [ ] **Backup important data** regularly
- [ ] **Validate configurations** after updates

### **Development Workflow**
- [ ] **Check for existing files** before creating new ones
- [ ] **Use MCP server** for operations when possible
- [ ] **Follow cursor rules** for all operations
- [ ] **Update documentation** as you go
- [ ] **Run compliance checks** regularly

## ğŸ”§ **Automation Scripts**

### **Service Management**
```bash
# âœ… Start all services (LivingTruthEngine group)
cd /home/mccoy/Projects/NotebookLM/LivingTruthEngine
docker compose -f docker/docker-compose.yml up -d

# âœ… Stop all services
cd /home/mccoy/Projects/NotebookLM/LivingTruthEngine
docker compose -f docker/docker-compose.yml down

# âœ… Validate Docker setup
./scripts/setup/validate_docker.sh

# âœ… Update system components
./scripts/setup/update_system.sh
```

### **Development Automation**
```bash
# âœ… Check system status
./scripts/setup/check_system.sh

# âœ… Run tests
./scripts/testing/run_tests.sh
./scripts/testing/trace_performance.sh
./scripts/testing/simple_performance_test.sh
./scripts/testing/functional_tests.py  # Comprehensive functional testing

# âœ… Deploy application
./scripts/deployment/deploy.sh
```

### **MCP Server Integration**
```bash
# âœ… Use MCP tools for operations
mcp_living_truth_fastmcp_server_get_status()
mcp_living_truth_fastmcp_server_query_flowise("query")
mcp_living_truth_fastmcp_server_analyze_transcript("transcript_name")
```

## ğŸš¨ **Common System Issues to Avoid**

### **Environment Issues**
- âŒ **Not activating virtual environment** before Python operations
- âŒ **Using system Python** instead of project environment
- âŒ **Hardcoding configuration** instead of environment variables
- âŒ **Not validating environment** before operations
- âŒ **Mixing environments** across different projects

### **Automation Issues**
- âŒ **Manual operations** that could be automated
- âŒ **Not using MCP server** for available operations
- âŒ **Inconsistent script usage** across team
- âŒ **Not updating documentation** with changes
- âŒ **Skipping validation steps**

### **System Maintenance Issues**
- âŒ **Not updating components** regularly
- âŒ **Accumulating unused resources** (Docker images, logs)
- âŒ **Not monitoring system health**
- âŒ **No backup strategy** for important data
- âŒ **Ignoring security updates**

## ğŸ“Š **System Management Metrics**

- âœ… **Environment consistency**: 100% virtual environment usage
- âœ… **Automation coverage**: 90%+ operations automated
- âœ… **System updates**: Monthly component updates
- âœ… **Resource efficiency**: <10% unused resources
- âœ… **Documentation**: 100% operations documented

## ğŸ¯ **System Management Workflow**

### **1. Daily Operations**
```bash
# Start development environment
source living_venv/bin/activate
./scripts/setup/start_services.sh

# Check system status
./scripts/setup/check_system.sh
```

### **2. Weekly Maintenance**
```bash
# Update system components
./scripts/setup/update_system.sh

# Clean up resources
docker system prune
docker image prune -f

# Validate configurations
./scripts/setup/validate_docker.sh
```

### **3. Monthly Review**
```bash
# Comprehensive system check
./scripts/setup/check_system.sh
./scripts/setup/validate_docker.sh

# Update documentation
# Review and update cursor rules
# Check for security updates
```

## ğŸ” **Monitoring and Validation**

### **System Health Checks**
```bash
# âœ… Service status
docker compose -f docker/docker-compose.yml ps

# âœ… Environment validation
python -c "import sys; print('Python:', sys.version)"
node --version
docker --version

# âœ… MCP server status
mcp_living_truth_fastmcp_server_get_status()
```

### **Performance Monitoring**
```bash
# âœ… Resource usage
docker stats
df -h
free -h

# âœ… Service response times
curl -w "@curl-format.txt" -o /dev/null -s http://localhost:3000/
```

### **Log Analysis**
```bash
# âœ… Service logs
docker compose -f docker/docker-compose.yml logs -f

# âœ… Application logs
tail -f logs/application.log

# âœ… Error monitoring
grep -i error logs/*.log
```

## ğŸ› ï¸ **Troubleshooting Guide**

### **Common Problems**
1. **Environment not activated**: `source living_venv/bin/activate`
2. **Port conflicts**: Stop conflicting services, check `netstat -tulpn`
3. **Docker issues**: Restart Docker daemon, validate compose file
4. **MCP server errors**: Check configuration, restart server
5. **Permission issues**: Check file permissions, use correct user

### **Recovery Procedures**
```bash
# âœ… Full system restart
./scripts/setup/stop_services.sh
./scripts/setup/start_services.sh

# âœ… Environment reset
deactivate
source living_venv/bin/activate

# âœ… Docker reset
docker compose -f docker/docker-compose.yml down
docker compose -f docker/docker-compose.yml up -d
```

---

**Follow these system management practices to ensure reliable, efficient, and maintainable operations.**

@coding_standards.mdc
@development_workflow.mdc
@docker_best_practices.mdc
